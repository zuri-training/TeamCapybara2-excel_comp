{% extends 'core/base_file.html' %}
{% load static %}
{% block extra_css %} 
<link rel="stylesheet" href="{% static 'core/css/result.css' %}">
<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.css" /> -->
<link rel="stylesheet" href="https://unpkg.com/x-data-spreadsheet@1.1.5/dist/xspreadsheet.css">

<style>
  .page-container {
    padding: 0;
  }

  table {
    border-collapse: collapse;
    width: 100%;
  }

  th, td {
    text-align: center;
    padding: 8px;
    width: 40px;
    height: 20px;
  }

  tr:nth-child(even) {background-color: #f2f2f2;}

</style>
{% endblock %}


{% block content %} 
<main class="page-container">
  <div class="container">
  <img src="{% static 'core/images/logo.svg' %}" alt="brand" />
    <h1>Results</h1>
    <!-- <div class="results">
     
      <div class="result" id="example"></div>
      <div class="result" id="example1"></div>
      
    </div> -->

    <div id="example"></div>
    <h1>Summary</h1>
    <div class="summary">
      <div class="space top"><p>Total number of duplicates: 17</p></div>
      <div class="detail">
        <div>
          <label class="label">File size:</label>
          <!--deet is details of summary -->
          <label class="deet">16KB</label>
        </div>
        <div>
          <label class="label">File size:</label>
          <!--deet is details of summary -->
          <label class="deet">16KB</label>
        </div>
      </div>
      <div class="detail">
        <div>
          <label class="label">Created:</label>
          <!--deet is details of summary -->
          <label class="deet">08/06/2021</label>
        </div>
        <div>
          <label class="label">Created:</label>
          <!--deet is details of summary -->
          <label class="deet">08/06/2021</label>
        </div>
      </div>
      <div class="detail">
        <div>
          <label class="label">Last Modfied:</label>
          <!--deet is details of summary -->
          <label class="deet">16/10/2022</label>
        </div>
        <div>
          <label class="label">Last Modfied:</label>
          <!--deet is details of summary -->
          <label class="deet">16/10/2022</label>
        </div>
      </div>
      <div class="detail">
        <div>
          <label class="label">Last modified by:</label>
          <!--deet is details of summary -->
          <label class="deet">John Doe</label>
        </div>
        <div>
          <label class="label">Last modified by:</label>
          <!--deet is details of summary -->
          <label class="deet">John Doe</label>
        </div>
      </div>
      <div class="space"></div>
    </div>
    <h1>Select Download Option</h1>
    <div class="options">
      <div>
        <div>
          <a href="#"
            ><button>Single document, duplicates highlighted</button></a
          >
        </div>
        <div>
          <a href="#"><button>Two document, duplicates removed</button></a>
        </div>
      </div>
      <div>
        <div>
          <a href="#"
            ><button>Single documents, duplicates highlighted</button></a
          >
        </div>
        <div>
          <a href="#"><button>Two documents, duplicates removed</button></a>
        </div>
      </div>
    </div>
  </div>
</main>

{{ data|json_script:"result2" }}
{% endblock %}


{% block extra_script %} 
<script src="https://unpkg.com/x-data-spreadsheet@1.1.5/dist/xspreadsheet.js"></script>
<script>

  
  const options = {
        mode: 'read', // edit | read
        showToolbar: false,
        showGrid: true,
        showContextmenu: false,
        view: {
          // height: () => (document.documentElement.clientHeight/2),
          height: () => 1000,
          // width: () => document.documentElement.clientWidth/2.5,
          width: () => 600,   
        },
        row: {
          len: 100,
          height: 20,
        },
        col: {
          len: 26,
          width: 70,
          indexWidth: 60,
          minWidth: 60,
        },
        style: {
          bgcolor: '#ffffff',
          align: 'left',
          valign: 'middle',
          textwrap: false,
          strike: false,
          underline: false,
          color: '#0a0a0a',
          font: {
            name: 'Helvetica',
            size: 10,
            bold: false,
            italic: false,
          },
        },
      }

//       const myData2 = [{
//       name: 'sheet-test-1',
//       freeze: 'B3',
//       styles: [
//         {
//           bgcolor: '#f4f5f8',
//           textwrap: true,
//           color: '#900b09',
//           border: {
//             top: ['thin', '#0366d6'],
//             bottom: ['thin', '#0366d6'],
//             right: ['thin', '#0366d6'],
//             left: ['thin', '#0366d6'],
//           },
//         },
//         {
//           bgcolor: 'yellow',
//           textwrap: false,
//           color: '#fff',
//           border: {
//             top: ['thin', '#036ed6'],
//             bottom: ['thin', '#03f6d6'],
//             right: ['thin', ''],
//             left: ['thin', ''],
//           },
//         }
//       ],
//       merges: [
//         'C3:D4',
//       ],
//       rows: {
//         1: {
//           cells: {
//             0: { text: 'testingtesttestetst', style: 1 },
//             2: { text: 'testing' },
//           },
//         },
//         2: {
//           height: 70,
//           cells: {
//             0: { text: 'render' ,style: 1},
//             1: { text: 'Hello',style: 1 },
//             2: { text: 'haha', style: 1},
//           }
//         },
//         8: {
//           cells: {
//             8: { text: 'border test', style: 1 },
//           }
//         }
//       },
//     }, 
//     { name: 'sheet-test' }
// ]

// const mySpreadSheet = x_spreadsheet(document.getElementById("demo"),options)
//   .loadData(myData2)


const da = JSON.parse("{{ result|safe|escapejs }}")
  
const myData = [{
  name: 'sheet-test-1',
  // freeze: 'B3',
  styles: [
    {
      bgcolor: '#f4f5f8',
      textwrap: true,
      color: '#900b09',
      border: {
        top: ['thin', '#0366d6'],
        bottom: ['thin', '#0366d6'],
        right: ['thin', '#0366d6'],
        left: ['thin', '#0366d6'],
      },
    },
    {
          bgcolor: 'yellow',
          textwrap: false,
          color: '#fff',
          border: {
            top: ['thin', '#036ed6'],
            bottom: ['thin', '#03f6d6'],
            right: ['thin', ''],
            left: ['thin', ''],
          },
        }
  ],
  
  rows: da
}, 
{ name: 'sheet-test' }
]

  const s = x_spreadsheet(document.getElementById("example"),options)
  .loadData(myData) // load data

  const dup_data = JSON.parse("{{ duplicates|safe|escapejs }}")
  
  const myData1 = [{
    name: 'sheet-test-1',
    // freeze: 'B3',
    styles: [
      {
        bgcolor: '#f4f5f8',
        textwrap: true,
        color: '#900b09',
        border: {
          top: ['thin', '#0366d6'],
          bottom: ['thin', '#0366d6'],
          right: ['thin', '#0366d6'],
          left: ['thin', '#0366d6'],
        },
      },
    ],
    
    rows: dup_data
  }, 
  { name: 'sheet-test' }
  ]
  

  const s1 = x_spreadsheet(document.getElementById("example1"),options)
  .loadData(myData1) // load data

  
    let duplicates = document.getElementsByClassName('duplicates')
    let myTable = document.getElementsByClassName('dataframe')[0]

    for (let i of duplicates) {
        let value = Number(i.innerHTML)
        myTable.rows[value+1].style.background = "green"
    }
    
</script>
{% endblock %}